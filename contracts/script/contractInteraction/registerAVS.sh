#!/bin/bash

# Set these environment variables before running:
# export IMUA_RPC_URL="https://your.rpc.url"
# export PRIVATE_KEY="your_private_key"
source .env


CONTRACT="0x72A5016ECb9EB01d7d54ae48bFFB62CA0B8e57a5"

# Parameters
SENDER="0x88826a677aDB340F0c7b8CCd6aF6aD96a40b0085"
AVS_NAME="TriggerX"
MIN_STAKE_AMOUNT=1
TASK_ADDRESS="0x72A5016ECb9EB01d7d54ae48bFFB62CA0B8e57a5"
SLASH_ADDRESS="0x72A5016ECb9EB01d7d54ae48bFFB62CA0B8e57a5"
REWARD_ADDRESS="0x72A5016ECb9EB01d7d54ae48bFFB62CA0B8e57a5"
AVS_OWNER_ADDRESSES="[$SENDER]"
WHITELIST_ADDRESSES="[]"
ASSET_IDS="[]"
AVS_UNBONDING_PERIOD=7
MIN_SELF_DELEGATION=0
EPOCH_IDENTIFIER="minute"
MINI_OPT_IN_OPERATORS=1
MIN_TOTAL_STAKE_AMOUNT=3
AVS_REWARD_PROPORTION=3
AVS_SLASH_PROPORTION=3

# Call registerAVS
cast send $CONTRACT "registerAVS((address,string,uint64,address,address,address,address[],address[],string[],uint64,uint64,string,uint64,uint64,uint64,uint64))" \
"($SENDER,\"$AVS_NAME\",$MIN_STAKE_AMOUNT,$TASK_ADDRESS,$SLASH_ADDRESS,$REWARD_ADDRESS,$AVS_OWNER_ADDRESSES,$WHITELIST_ADDRESSES,$ASSET_IDS,$AVS_UNBONDING_PERIOD,$MIN_SELF_DELEGATION,\"$EPOCH_IDENTIFIER\",$MINI_OPT_IN_OPERATORS,$MIN_TOTAL_STAKE_AMOUNT,$AVS_REWARD_PROPORTION,$AVS_SLASH_PROPORTION)" \
--rpc-url "$IMUA_RPC_URL" \
--private-key "$PRIVATE_KEY"